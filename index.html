<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Fireplace</title>
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <script type="text/x-handlebars" id="slides">
    <div class="slide">
      <button {{action toggleJSON}} class="toggle-json">
        {{#if showingJSON}}&raquo;{{else}}&laquo;{{/if}}
      </button>
      {{outlet}}
    </div>

    <div class="controls">
      {{#if previousSlideNum}}
        <button {{action previousSlide}} class="prev-button control-button">&larr;</button>
      {{/if}}

      <div class="current-slide-num">
        {{currentSlideNum}}
      </div>

      {{#if nextSlideNum}}
        <button {{action nextSlide}} class="next-button control-button">&rarr;</button>
      {{/if}}
    </div>

    <div class="json">
      <pre>{{json currentJSON}}</pre>
      <button class="clear-json" {{action clearData}}>x</button>
      <button class="focus-json" {{action focusJSON}}>+</button>
    </div>
  </script>

  <script type="text/x-handlebars" id="slides/slide1">
    <h1>Firebase</h1>
    <p>&ldquo;Scalable real-time backend&rdquo;</p>
  </script>

  <script type="text/x-handlebars" id="slides/slide2">
    <h1>Syncronized JSON blob</h1>

    <div class="code"><div><pre>
{              => foo.firebaseio.com
  "foo": {     => foo.firebaseio.com/foo
    "bar": {   => foo.firebaseio.com/foo/bar
      "baz": 1 => foo.firebaseio.com/foo/bar/baz
    }
  }
}</pre></div></div>

    <ul>
      <li>child_added</li>
      <li>child_removed</li>
      <li>child_changed</li>
      <li>child_moved</li>
      <li>value</li>
    </ul>
  </script>

  <script type="text/x-handlebars" id="slides/slide3">
    <h1>EmberFire</h1>

    <div class="code"><div><pre>
App.IndexRoute = Ember.Route.extend({
  model: function() {
    return EmberFire.Array.create({
      ref: new Firebase("https://<my-firebase>.firebaseio.com/list")
    });
  }
});</pre></div></div>
  </script>

  <script type="text/x-handlebars" id="slides/slide4">
    <h1>Fireplace</h1>

    <div class="code"><div><pre>
App.Person = FP.Model.extend({
  firstName: FP.attr(),
  lastName:  FP.attr(),
  dob:       FP.attr("date"),
  addresses: FP.hasMany()
});

App.Address = FP.Model.extend({
  number:   FP.attr(),
  street:   FP.attr(),
  city:     FP.attr(),
  postcode: FP.attr()
});</pre></div></div>
  </script>

  <script type="text/x-handlebars" id="slides/slide5">
    <h1>Attributes</h1>

    <div class="code"><div><pre>
var attr = FP.attr;
App.Person = FP.Model.extend({
  firstName: attr(),
  lastName:  attr({key: "surname"}),
  age:       attr("number"),
  isAdmin:   attr("boolean", {default: false}),

  dob: attr("date", {default: function() {
    return new Date();
  }}),

  logins: attr("hash", {of: "timestamp"})
});</pre></div></div>
  </script>

  <script type="text/x-handlebars" id="slides/slide6">
    <h1>The Store</h1>

    <div class="code"><div><pre>
App.Store = FP.Store.extend({
  firebaseRoot: "https://your-app.firebase.io"
});</pre></div></div>
  </script>

  <script type="text/x-handlebars" id="slides/slide7">
    <h1>Creating Records</h1>

    <div class="code"><div><pre>
var person = this.store.createRecord("person", {
  firstName: "John",
  lastName: "Watson",
  dob: new Date(Date.UTC(1852, 7, 7)),
  addresses: [
    this.store.createRecord("address", {
      number: "221B",
      street: "Baker Street",
      city: "London",
      postcode: "NW1 6XE"
    })
  ]
});

person.save();</pre></div></div>

    <p>
      <button {{action createPerson}}>Run</button>
    </p>
  </script>

  <script type="text/x-handlebars" id="slides/slide8">
    <h1>Finding Records</h1>

    <div class="code"><div><pre>
App.PeopleRoute = Ember.Route.extend({
  model: function() {
    return this.store.fetch("person");
  }
});</pre></div></div>

    <ul>
      {{#each person in controller}}
        <li>
          {{person.firstName}} {{person.lastName}}
        </li>
      {{/each}}
    </ul>

    <p>
      <button {{action createRandomPerson}}>Add Person</button>
    </p>
  </script>

  <script type="text/x-handlebars" id="slides/slide9">
    <h1>Limiting Records</h1>

    <div class="code"><div><pre>
App.PeopleRoute = Ember.Route.extend({
  model: function() {
    return this.store.fetch("person", {limit: 5});
  }
});</pre></div></div>

    <ul>
      {{#each person in controller}}
        <li>
          {{person.firstName}} {{person.lastName}}
        </li>
      {{/each}}
    </ul>

    <p>
      <button {{action createRandomPerson}}>Add Person</button>
    </p>
  </script>

  <script type="text/x-handlebars" id="slides/slide10">
    <h1>Updating Records</h1>

    <div class="code"><div><pre>
person.setProperties({
  firstName: Faker.Name.firstName(),
  lastName:  Faker.Name.lastName()
});
person.save();</pre></div></div>

    <ul>
      {{#each person in controller}}
        <li {{action updatePerson person}}>
          {{person.firstName}} {{person.lastName}}
        </li>
      {{/each}}
    </ul>

    <p>
      <button {{action createRandomPerson}}>Add Person</button>
    </p>
  </script>

  <script type="text/x-handlebars" id="slides/slide11">
    <h1>Ordering Records</h1>

    <div class="code"><div><pre>
App.Company = FP.Model.extend({
  name: attr(),
  priority: Ember.computed.alias("name")
});</pre></div></div>

    <ul>
      {{#each company in controller}}
        <li {{action updateCompany company}}>
          {{company.name}}
        </li>
      {{/each}}
    </ul>

    <p>
      <button {{action createCompany}}>Add Company</button>
    </p>
  </script>

  <script type="text/x-handlebars" id="slides/slide12">
    <h1>Filtering Records</h1>

    <div class="code"><div><pre>
App.CompaniesRoute = Ember.Route.extend({
  model: function() {
    return this.store.fetch("company", {
      startAt: "A", endAt: "D"
    });
  }
});</pre></div></div>

    <ul>
      {{#each company in controller}}
        <li>
          {{company.name}}
        </li>
      {{/each}}
    </ul>

    <p>
      <button {{action createCompany}}>Add Company</button>
    </p>
  </script>

  <script type="text/x-handlebars" id="slides/slide13">
    <h1>Non-embedded Relationships</h1>

    <div class="code"><div><pre>
App.Company = FP.Model.extend({
  name: attr(),
  employees: hasMany("people", {embedded: false})
});</pre></div></div>

    <p>
      {{name}}
    </p>

    <h2>Employees</h2>
    <ul>
      {{#each person in employees}}
        <li {{action removeEmployee person}}>
          {{person.firstName}} {{person.lastName}}
        </li>
      {{/each}}
    </ul>

    <h2>Non-Employees</h2>
    <ul>
      {{#each person in nonEmployees}}
        <li {{action addEmployee person}}>
          {{person.firstName}} {{person.lastName}}
        </li>
      {{/each}}
    </ul>
  </script>

  <script type="text/x-handlebars" id="slides/slide14">
    <h1>Meta Models</h1>

    <div class="code"><div><pre>
App.Company = FP.Model.extend({
  name: attr(),
  employees: hasMany("people", {
    embedded: false,
    as: "employee"
  })
});

App.Employee = FP.MetaModel.extend({
  department: attr(),
  jobTitle: attr()
});</pre></div></div>

    <p>
      {{name}}
    </p>

    <h2>Employees</h2>
    <ul>
      {{#each person in employees itemController="employee_item"}}
        <li>
          {{person.firstName}} {{person.lastName}}
          {{input value=person.department placeholder="Department"}}
          {{input value=person.jobTitle placeholder="Job Title"}}
        </li>
      {{/each}}
    </ul>
  </script>

  <script type="text/x-handlebars" id="slides/slide15">
    <h1>Detached Relationships</h1>

    <div class="code"><div><pre>
App.Person = FP.Model.extend({
  companies: hasMany({
    detached: true,
    embedded: false,
    path: "employments/&#123;&#123;id&#125;&#125;"
  })
});</pre></div></div>

    <p>
      {{firstName}} {{firstName}}
    </p>

    <ul>
      {{#each company in companies}}
        <li {{action leaveCompany company}}>{{company.name}}</li>
      {{/each}}
    </ul>

    <h2>Other Companies</h2>
    <ul>
      {{#each company in otherCompanies}}
        <li {{action joinCompany company}}>{{company.name}}</li>
      {{/each}}
    </ul>
  </script>

  <script type="text/x-handlebars" id="slides/slide16">
    <h1>Customising Firebase References</h1>

    <div class="code"><div><pre>
App.Person.reopenClass({
  firebasePath: "folk"
});</pre></div></div>
  </script>

  <script type="text/x-handlebars" id="slides/slide17">
    <h1>Customising Firebase References</h1>

    <div class="code"><div><pre>
App.Person = FP.Model.extend({
  project: null
});

App.Person.reopenClass({
  firebasePath: "members/for/&#123;&#123;project.id&#125;&#125;"
});

this.store.fetch("person", {project: someProject}, {limit: 10})

App.Project = FP.Model.extend({
  people: hasMany({
    detached: true,
    query: function() { return {project: this}; }
  })
});</pre></div></div>
  </script>

  <script type="text/x-handlebars" id="slides/slide18">
    <h1>Ember Inspector &rarr;</h1>
  </script>

  <script type="text/x-handlebars" id="slides/slide19">
    <p>
      <a href="http://github.com/rlivsey/fireplace">http://github.com/rlivsey/fireplace</a>
    </p>
    <p>
      <a href="http://livsey.org/fireplace-presentation">http://livsey.org/fireplace-presentation</a>
    </p>
  </script>

  <script src='https://cdn.firebase.com/v0/firebase.js'></script>
  <script src="js/libs/jquery-1.10.2.js"></script>
  <script src="js/libs/handlebars-1.1.2.js"></script>
  <script src="js/libs/ember-1.2.0.js"></script>
  <script src="js/libs/ember-inflector.js"></script>
  <script src="js/libs/fireplace.js"></script>
  <script src="js/libs/faker.js"></script>
  <script src="js/app.js"></script>
  <script src="js/slides.js"></script>
</body>
</html>